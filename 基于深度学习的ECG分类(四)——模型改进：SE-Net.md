## 基于深度学习的ECG分类(四)——模型改进：SE-Net

前期我们主要对现有的论文进行复现与简单的改进，已经搭建好的CNN-GRU模型达到了98%的准确率。**进一步，我们想根据自己对于问题的理解，搭建自己的深度学习模型。**

首先回归到神经网络的本质，卷积神经网络的作用就是提取信号在空间上的特征，循环神经网络的作用是提取信号在时间上的特征。而我们之所以在CNN后面堆叠了GRU循环神经网络，是考虑到心电数据本身是时间序列，判断某一类心率不齐的关键点就在于QRS波段。由于这一波段在整个周期当中所占的比例是比较小的，这就类似于在语言模型中，接下来将会出现的词与之前出现已经出现的文字是密切相关的。

但是我们在训练神经网络的时候出现一个问题：随着CNN层网络层数的加深，最终分类的效果不增反降，甚至在训练集上的准确率也停滞不前。这时候我们考虑到ResNet的诞生背景：训练集上准确率下降不是由于过拟合造成的，而是加入了某些不该有的层。ResNet通过identity mapping，通过网络的训练，把不该有的层用identity代替，解决了上述问题。我们考虑：对于心电数据，某个患者的心率问题最直接的是由一个周期当中的某一波段起关键作用，其他波段虽然有影响，但作用较小。从图像上来看，基本从R波段就能判断一个人的心脏是否有问题；P,Q,S段虽然也能体现，但已经不是决定性因素。**因此我们就想设计一种网络结构，如何能做到放大某一部分的特征，而忽略一些不相关的特征，充分利用现有的卷积层而不再增加网络的深度。**

**后来通过查阅论文，发现早已有人提出了一种称为SE-Net的网络结构，就能实现上述设想。首先我们对SE-Net的原理进行介绍，然后再来看如何能把它应用到我们自己的模型上。**

### SE-Net

**SE-Net全称Squeeze-and-Excitation Networks，它基于这样的基本思想：所见即重要。**先前的大部分研究都是基于空间上的特征，而SE-Net则是从通道的角度来考虑，由于不同的卷积核刻画了信号的不同方面的特征，有些特征是重要的，而有些特征可以忽略，如何计算一个通道维度上的权重来对通道进行加权处理成为了SE-Net的核心。

![](figure\SENet.png)

上图是SE-Net论文中的原图，其中$F_{tr}$是传统的卷积结构，$X$和$U$分别是$F_{tr}$的输入（$C'\times H'\times W'$）和输出（$C\times H\times W$），这些与普通的卷积神经网络并无差别。SE-Net作出改进的部分是卷积结束后的部分，这一部分便是计算一个通道维度上的权重来对通道进行加权处理：首先对$U$先做一个Global Average Pooling（图中的$Fsq(.)$，即Squeeze过程），输出的$1\times1\times C$的数据再经过两个全连接层（图中的$Fex(.)$，即Excitation过程），最后用sigmoid（论文中的self-gating mechanism）限制到[0，1]的范围，这就是我们前面所说的通道维上的权重。把这个权重（称为scale）乘到刚刚卷积得到的$U$的$C$个通道上，作为下一层的输入。

### 将SE-Net应用到ECG数据中

